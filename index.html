<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate AI RecipeRecommender</title>

<style>
:root { --primary:#27ae60; --veg:#2ecc71; --nonveg:#e74c3c; --bg:#f4f6f8; }
body { font-family:'Segoe UI',sans-serif; background:var(--bg); margin:0; padding:20px; }
.container{ max-width:1200px; margin:auto; }
header{text-align:center; margin-bottom:20px;}
h1{margin:0;}

.search-area{background:white;padding:20px;border-radius:12px;box-shadow:0 4px 10px rgba(0,0,0,0.05);}
.controls{display:flex;gap:10px;flex-wrap:wrap;}
input,select,button{padding:12px;border-radius:8px;border:1px solid #ddd;font-size:15px;}
input{flex:2;}
select{flex:1;}
button{background:var(--primary);color:white;border:none;cursor:pointer;}
button:hover{background:#219150;}

.results-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px;margin-top:20px;}
.card{background:white;border-radius:12px;overflow:hidden;box-shadow:0 4px 10px rgba(0,0,0,0.05);position:relative;}
.card img{width:100%;height:180px;object-fit:cover;}
.card-content{padding:15px;}
.badge{font-size:11px;padding:4px 6px;border-radius:4px;font-weight:bold;}
.veg{background:#e8f5e9;color:var(--veg);}
.nonveg{background:#ffebee;color:var(--nonveg);}
.match{font-size:12px;color:#555;margin:5px 0;}
.favorite{position:absolute;top:10px;right:10px;font-size:22px;cursor:pointer;}
.steps{font-size:13px;color:#444;margin-top:10px;max-height:150px;overflow-y:auto;}
.youtube-btn{display:inline-block;margin-top:10px;padding:6px 10px;background:#c4302b;color:white;text-decoration:none;border-radius:6px;font-size:13px;}
.favorites-section{margin-top:40px;}
.suggestions{background:white;position:absolute;border:1px solid #ddd;width:250px;display:none;z-index:10;}
.suggestions div{padding:8px;cursor:pointer;}
.suggestions div:hover{background:#f1f1f1;}
</style>
</head>

<body>

<div class="container">

<header>
<h1>ü•ó Ultimate AI RecipeRecommender</h1>
<p id="subtitle">AI Match ‚Ä¢ Step Guide ‚Ä¢ Tamil Videos ‚Ä¢ Favorites</p>
</header>

<div class="search-area">
<div class="controls">
<input type="text" id="userInput" placeholder="Enter ingredient (e.g potato)">
<select id="dietType">
<option value="all">All</option>
<option value="veg">Veg</option>
<option value="nonveg">Non-Veg</option>
</select>
<button onclick="searchRecipes()">Search</button>
</div>
<div id="suggestions" class="suggestions"></div>
</div>

<div id="results" class="results-grid"></div>

<div class="favorites-section">
<h2>‚ù§Ô∏è Favorites</h2>
<div id="favorites" class="results-grid"></div>
</div>

</div>

<script>

let allMeals=[];

// Load all meals
async function loadMeals(){
const res=await fetch("https://www.themealdb.com/api/json/v1/1/search.php?s=");
const data=await res.json();
allMeals=data.meals;
}
loadMeals();

// Calculate Match %
function calculateMatch(meal,input){
let score=0,total=0;
for(let i=1;i<=20;i++){
let ing=meal["strIngredient"+i];
if(ing){
total++;
if(ing.toLowerCase().includes(input)) score++;
}
}
return total?Math.round((score/total)*100):0;
}

// Search
function searchRecipes(){
const input=document.getElementById("userInput").value.toLowerCase();
const diet=document.getElementById("dietType").value;
const results=document.getElementById("results");
results.innerHTML="";

let filtered=allMeals.map(meal=>{
meal.matchScore=calculateMatch(meal,input);
return meal;
}).filter(meal=>meal.matchScore>0);

filtered.sort((a,b)=>b.matchScore-a.matchScore);

filtered.slice(0,10).forEach(meal=>{
const nonVegCats=['chicken','beef','pork','lamb','seafood','goat'];
const isNonVeg=nonVegCats.includes(meal.strCategory.toLowerCase());

if(diet==="veg"&&isNonVeg)return;
if(diet==="nonveg"&&!isNonVeg)return;

renderMeal(meal,isNonVeg);
});
}

// Render Meal Card
function renderMeal(meal,isNonVeg){
const container=document.getElementById("results");
const card=document.createElement("div");
card.className="card";

let steps=meal.strInstructions
? meal.strInstructions.split(". ").map(s=>`<li>${s.trim()}</li>`).join("")
: "<li>No instructions available.</li>";

let youtubeLink=`https://www.youtube.com/results?search_query=${encodeURIComponent(meal.strMeal+" Tamil recipe")}`;

card.innerHTML=`
<div class="favorite" onclick="saveFavorite('${meal.idMeal}')">‚ù§Ô∏è</div>
<img src="${meal.strMealThumb}">
<div class="card-content">
<span class="badge ${isNonVeg?'nonveg':'veg'}">${isNonVeg?'Non-Veg':'Veg'}</span>
<h3>${meal.strMeal}</h3>
<div class="match">Match: ${meal.matchScore}%</div>

<h4>Steps:</h4>
<ol class="steps">${steps}</ol>

<a class="youtube-btn" href="${youtubeLink}" target="_blank">‚ñ∂ Watch in Tamil</a>
</div>
`;
container.appendChild(card);
}

// Favorites
function saveFavorite(id){
let fav=JSON.parse(localStorage.getItem("favorites")||"[]");
if(!fav.includes(id)){
fav.push(id);
localStorage.setItem("favorites",JSON.stringify(fav));
displayFavorites();
}
}

function displayFavorites(){
const favContainer=document.getElementById("favorites");
favContainer.innerHTML="";
let fav=JSON.parse(localStorage.getItem("favorites")||"[]");
fav.forEach(id=>{
let meal=allMeals.find(m=>m.idMeal===id);
if(meal){
const card=document.createElement("div");
card.className="card";
card.innerHTML=`
<img src="${meal.strMealThumb}">
<div class="card-content">
<h4>${meal.strMeal}</h4>
</div>
`;
favContainer.appendChild(card);
}
});
}
displayFavorites();

// Auto Suggestions
document.getElementById("userInput").addEventListener("input",function(){
const value=this.value.toLowerCase();
const box=document.getElementById("suggestions");
box.innerHTML="";
if(!value){box.style.display="none";return;}

let matches=allMeals.filter(m=>m.strMeal.toLowerCase().includes(value)).slice(0,5);
matches.forEach(m=>{
let div=document.createElement("div");
div.innerText=m.strMeal;
div.onclick=()=>{
document.getElementById("userInput").value=m.strMeal;
box.style.display="none";
};
box.appendChild(div);
});
box.style.display="block";
});

</script>

</body>
</html>
